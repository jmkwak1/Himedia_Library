<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.care.library.admin.AdminMapper">
	<resultMap type="com.care.library.member.MemberDTO" id="memberDto"> <!-- id는 식별자일뿐 -->
  		<result column = "pro_name" property = "proName"/>
  		<result column = "detail_address" property = "detailAddress"/>
  		<result column = "reg_date" property = "regDate"/>
  		<result column = "post_code" property = "postCode"/>
  		<result column = "auth_date" property = "authDate"/>
  		<result column = "user_group" property = "userGroup"/>
  	</resultMap>
  	<resultMap type="com.care.library.user.InquiryDTO" id="inquiryDto">
  		<result column = "write_date" property = "writeDate"/>
  		<result column = "reply_content" property = "replyContent"/>
  	</resultMap>
  	
  	<select id = "count">
  		SELECT count(id) FROM member
  	</select>
	
	<select id = "selectMember" resultMap="memberDto">
		SELECT ROWNUM() as rn, AAA.* FROM (SELECT * FROM member WHERE status = #{memberSelect} ORDER BY auth_date ASC)AAA
	</select>
	
	<select id = "selectUser" resultMap="memberDto">
		SELECT * FROM member WHERE id = #{id}
	</select>
	
	<update id = "memberConfirm" parameterType="com.care.library.member.MemberDTO">
		UPDATE member SET status = 'A', user_group = #{userGroup}, paper = #{paper}, auth_date = #{authDate} WHERE id = #{id}
	</update>
	
	<update id = "memberReject">
		UPDATE member SET status = 'D', reject = #{reject} WHERE id = #{id}
	</update>
	
	<select id="selectInquiry" resultMap="inquiryDto">
		SELECT BBB.* FROM (SELECT ROWNUM() as rn, AAA.* FROM(SELECT * FROM inquiry ORDER BY no ASC)AAA)BBB WHERE BBB.rn BETWEEN #{begin} AND #{end}
	</select>
	
	<select id="countInquiry">
		SELECT count(no) FROM inquiry
	</select>
	
	<select id="selectInquiryContent" resultMap="inquiryDto">
		SELECT * FROM inquiry WHERE no=#{no}
	</select>
	
	<update id ="replyWrite">
		UPDATE inquiry SET reply_content = #{content}, reply = 'Y' WHERE no = #{no}
	</update>
</mapper>



  