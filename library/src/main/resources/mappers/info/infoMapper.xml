<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.care.library.info.InfoMapper">
  	<resultMap type="com.care.library.info.NoticeDTO" id="noticeDto">
  		<result column = "file_name" property = "fileName"/>
  		<result column = "image_name" property = "imageName"/>
  		<result column = "write_date" property = "writeDate"/>
  	</resultMap>
  	
  	<select id = "findMaxNum">
  		SELECT MAX(no) FROM notice
  	</select>
  	
  	<insert id = "writeNotice">
  		INSERT INTO notice (no, title, content, file_name, writer, write_date, hits, image_name) VALUES (#{no}, #{title}, #{content}, #{fileName}, #{writer}, #{writeDate}, #{hits}, #{imageName})
  	</insert>
  	
  	<select id = "selectAllNotice" resultMap="noticeDto">
  		SELECT AAA.* FROM (SELECT rownum as rn, notice.* FROM notice ORDER BY no DESC)AAA WHERE AAA.rn BETWEEN #{begin} AND #{end}
  	</select>
  	
  	<select id = "count">
  		SELECT count(no) FROM notice
  	</select>
  	
  	<select id="selectNotice" resultMap="noticeDto">
  		<if test="select == 'title'">
	  		SELECT BBB.* FROM(SELECT rownum as rn, AAA.* FROM(SELECT * FROM notice WHERE ${select} like '%'||#{search}||'%' ORDER BY no ASC)AAA)BBB WHERE rn BETWEEN #{begin} AND #{end}
  		</if>
  		<if test="select == 'no'">
	  		SELECT BBB.* FROM(SELECT rownum as rn, AAA.* FROM(SELECT * FROM notice WHERE ${select} = #{search} ORDER BY no ASC)AAA)BBB WHERE rn BETWEEN #{begin} AND #{end}
  		</if>
  	</select>
  	
  	<select id="selectNoticeContent" resultMap="noticeDto">
  		SELECT * FROM notice WHERE no = #{no}
  	</select>
  	
  	<update id="updateNoticeHit">
  		UPDATE notice SET hits = hits+1 WHERE no = #{no}
  	</update>
  	
  	<delete id="deleteNotice">
  		DELETE notice WHERE no = #{no}
  	</delete>
  	
  	<update id = "updateNotice">
  		UPDATE notice SET title = #{title}, content = #{content} WHERE no = #{no}
  	</update>
  	
  	<update id = "updateNoticeFile" parameterType="com.care.library.info.NoticeDTO">
  		UPDATE notice SET title = #{title}, content = #{content}, file_name = #{fileName} WHERE no = #{no}
  	</update>
  	
  	<select id = "findMaxNumFaq">
  		SELECT MAX(no) FROM faq
  	</select>
  	
  	<insert id="writeFaq">
  		INSERT INTO faq (no, category, title, content) VALUES (#{no}, #{category}, #{title}, #{content})
  	</insert>
  	
  	<select id = "selectFaq" resultType = "com.care.library.info.FaqDTO">
  		SELECT rownum as rn, AAA.* FROM (SELECT * FROM faq WHERE category = #{category})AAA
  	</select>
  	
  	<select id = "selectFaqContent" resultType = "com.care.library.info.FaqDTO">
  		SELECT * FROM faq WHERE no = #{no}
  	</select>
  	
  	<update id = "updateFaq" parameterType="com.care.library.info.FaqDTO">
  		UPDATE faq SET category = #{category}, title = #{title}, content = #{content} WHERE no = #{no}
  	</update>
  	
  	<delete id = "deleteFaq">
  		DELETE faq WHERE no = #{no}
  	</delete>
</mapper>



  